/* Generated from JavaScript source files. Do not modify directly. */
window.LabelBlanc=window.LabelBlanc||{},window.LabelBlanc.SaveAndThen=window.LabelBlanc.SaveAndThen||{},function(a){var b=window.LabelBlanc.SaveAndThen;a(function(){var c=b.config,d=a("#post");c&&d.length&&new b.PostEditForm(d,c)}),b.PostEditForm=function(a,c){if(c.actions&&0!==c.actions.length){this.$form=a,this.config=c;var d=this.getDefaultAction();1!==c.actions.length||c.actions[0].enabled||(this.config.newButtonSetIsDummy=!0,d=c.actions[0]),this.$actionInput=this.createActionInput(),this.$originalPublishButton=this.getOriginalPublishButton(),this.newPublishButtonSet=new b.PublishButtonSet(this),this.$spinner=this.$form.find("#publishing-action .spinner"),this.setupForm(),this.setupOriginalPublishButton(),this.newPublishButtonSet.setAction(d),this.setupFormListeners(),this.setupWordpressListeners(),this.newPublishButtonSet.hideMenu(),this.insertNewPublishButtonSet(),this.updateSpinner(),this.config.newButtonSetIsDummy&&this.newPublishButtonSet.disable(!0)}},b.PostEditForm.LAST_USED_COOKIE_NAME="lb-sat-last-used-action",b.PostEditForm.prototype={getOriginalPublishButton:function(){return this.$form.find("#publish")},updateSpinner:function(){this.$spinner.addClass("lb-sat-spinner").hide(),this.$originalPublishButton.before(this.$spinner)},insertNewPublishButtonSet:function(){var b=this.newPublishButtonSet.$container,c=a('<div class="lb-sat-separator"></div>');this.config.setAsDefault?this.$originalPublishButton.after(b).after(c):this.$originalPublishButton.before(b).before(c)},createActionInput:function(){return a('<input type="hidden" name="'+b.HTTP_PARAM_ACTION+'" />')},setupForm:function(){this.$form.prepend(this.$actionInput)},setupFormListeners:function(){var a=this;this.$form.on("submit",function(){a.newPublishButtonSet.disable(!0)})},setupOriginalPublishButton:function(){this.config.setAsDefault&&!this.config.newButtonSetIsDummy&&this.$originalPublishButton.removeClass("button-primary").removeAttr("accesskey")},setAction:function(a){wpCookies.set(b.PostEditForm.LAST_USED_COOKIE_NAME,a.id,31536e3),this.$actionInput.val(a.id)},getDefaultAction:function(){var c,d=this.config.defaultActionId,e=null;if(a.each(this.config.actions,function(a,b){return b.enabled?(c=b,!1):void 0}),!d)return c;if(b.ACTION_LAST===d){var f=wpCookies.get(b.PostEditForm.LAST_USED_COOKIE_NAME);if(!f)return c;d=f}return e=this.getActionFromId(d),e&&e.enabled||(e=c),e},getActionFromId:function(b){var c=null;return a.each(this.config.actions,function(a,d){return d.id===b?(c=d,!1):void 0}),c},setupWordpressListeners:function(){var b=this;a(document).on("autosave-disable-buttons.edit-post",function(){b.newPublishButtonSet.disable(!0)}).on("autosave-enable-buttons.edit-post",function(){wp.heartbeat&&wp.heartbeat.hasConnectionError()||b.config.newButtonSetIsDummy||b.newPublishButtonSet.disable(!1)}),this.$form.on("click","#post-visibility-select .cancel-post-visibility,#post-visibility-select .save-post-visibility,#timestampdiv .cancel-timestamp,#timestampdiv .save-timestamp,#post-status-select .save-post-status,#post-status-select .cancel-post-status",function(){b.newPublishButtonSet.updateLabels()})}},b.PublishButtonSet=function(a){this.postEditForm=a,this.config=this.postEditForm.config,this.action=null,this.$mainButton=this.createMainButton(),this.$dropdownButton=this.createDropdownButton(),this.$dropdownMenu=this.createDropdownMenu(),this.$container=this.createContainer(),this.setupDocumentClickListener(),this.setupMainButtonListeners(),this.setupDropdownButtonListeners(),this.setupDropdownMenuListeners()},b.PublishButtonSet.prototype={createMainButton:function(){var b=a('<input type="button" />');return b.attr("class","button button-large lb-sat-main-button"),this.config.setAsDefault&&!this.config.newButtonSetIsDummy?b.addClass("button-primary"):b.removeAttr("accesskey"),b},createDropdownButton:function(){var b=a('<input type="button" value="&#xf140;" />');return b.attr("class",this.$mainButton.attr("class")),b.removeClass("lb-sat-main-button").addClass("lb-sat-dropdown-button"),b},createDropdownMenu:function(){var b=a('<ul class="lb-sat-dropdown-menu"></ul>'),c=this;return a.each(this.config.actions,function(d,e){var f=a('<li data-lb-sat-value="'+e.id+'">'+c.generateButtonLabel(e.buttonLabelPattern)+"</li>");e.title&&f.attr("title",e.title),e.enabled?f.data("lbSatActionData",e):f.addClass("disabled"),b.append(f)}),b},createContainer:function(){var b=a('<span class="lb-sat-container"></span>');return b.append(this.$mainButton),this.config.actions.length>1&&b.addClass("lb-sat-with-dropdown").append(this.$dropdownButton).append(this.$dropdownMenu),this.config.setAsDefault&&b.addClass("lb-sat-set-as-default"),b},setupDocumentClickListener:function(){var b=this;a(document).click(function(){b.menuShown()&&b.hideMenu()})},setupMainButtonListeners:function(){var b=this;this.$mainButton.click(function(){a(this).hasClass("disabled")||b.config.newButtonSetIsDummy||(b.$container.before(b.postEditForm.$spinner),b.postEditForm.setAction(b.action),b.postEditForm.$originalPublishButton.trigger("click"))})},setupDropdownButtonListeners:function(){var a=this;this.$dropdownButton.click(function(b){a.menuShown()||(a.showMenu(),b.stopPropagation())})},setupDropdownMenuListeners:function(){var b=this;this.$dropdownMenu.on("click","li",function(){a(this).hasClass("disabled")||b.config.newButtonSetIsDummy||(b.setAction(a(this).data("lbSatActionData")),b.$mainButton.click())})},menuShown:function(){return this.$container.hasClass("lb-sat-dropdown-menu-shown")},showMenu:function(){this.$container.addClass("lb-sat-dropdown-menu-shown")},hideMenu:function(){this.$container.removeClass("lb-sat-dropdown-menu-shown")},setAction:function(a){this.action=a,this.updateLabels()},updateLabels:function(){var b=this;this.$mainButton.val(this.generateButtonLabel(this.action.buttonLabelPattern)),a.each(this.config.actions,function(a,c){var d=b.$dropdownMenu.find("[data-lb-sat-value="+c.id+"]");d.text(b.generateButtonLabel(c.buttonLabelPattern))})},generateButtonLabel:function(a){return a.replace("%s",this.postEditForm.$originalPublishButton.val())},disable:function(a){this.$mainButton.toggleClass("disabled",a),this.$dropdownButton.toggleClass("disabled",a),a?(this.hideMenu(),this.$mainButton.prop("disabled",!0)):this.$mainButton.prop("disabled",!1)}}}(jQuery);